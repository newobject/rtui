#!/usr/bin/env ruby
require "rubygems"

BANNER = <<BANNER
RTUI - Eye candy for ruby command line apps.

  install   -    Dumps rtui to a single file for standalone use.
  help      -    Prints RTUI Readme.

BANNER

FILES = ["progress", "dump", "table"]
ME = "rtui"

class CLI
  def self.install
    out = FILES.map do |file|
      read = File.read(Gem.required_location(ME, "#{ME}/#{file}.rb"))
      read.gsub!(/module RTUI|^end|/, "") # Remove bunch of modules and ends
      read.gsub!(/^\s*#.*\n|^\s*\n/, "")  # Remove comments and empty lines
    end
    File.open('rtui.rb', 'w') do |f|
      f.write("#\n# RTUI  -  http://github.com/nofxx/rtui\n#\nmodule RTUI\n#{out}end\n")
    end
    puts "RTUI copied to ./rtui.rb (#{File.size('rtui.rb')/1000}Kb). Have fun!"
  end

  def self.help
    puts File.read(Gem.required_location('rtui', 'rtui.rb').gsub(/lib\/rtui.rb/, "README.rdoc"))
  end
end

if ARGV.empty? || !CLI.respond_to?(ARGV[0])
  puts BANNER
else
  CLI.send(ARGV[0])
end

